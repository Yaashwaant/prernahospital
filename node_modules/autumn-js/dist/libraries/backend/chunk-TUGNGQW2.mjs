import {
  withAuth
} from "./chunk-UJBSJTAV.mjs";
import {
  BASE_PATH
} from "./chunk-KSG3E4Q2.mjs";

// src/libraries/backend/routes/analyticsRoutes.ts
import { addRoute } from "rou3";
var sanitizeBody = (body) => {
  const bodyCopy = { ...body };
  delete bodyCopy.customer_id;
  delete bodyCopy.customer_data;
  return bodyCopy;
};
var listEventsHandler = (options) => withAuth({
  fn: async ({
    autumn,
    customer_id,
    body
  }) => {
    return await autumn.events.list({
      ...sanitizeBody(body),
      customer_id
    });
  },
  suppressLogs: options?.suppressLogs
});
var aggregateEventsHandler = (options) => withAuth({
  fn: async ({
    autumn,
    customer_id,
    body
  }) => {
    return await autumn.events.aggregate({
      ...sanitizeBody(body),
      customer_id
    });
  },
  suppressLogs: options?.suppressLogs
});
var addAnalyticsRoutes = (router, options) => {
  addRoute(router, "POST", `${BASE_PATH}/events/list`, {
    handler: listEventsHandler(options)
  });
  addRoute(router, "POST", `${BASE_PATH}/events/aggregate`, {
    handler: aggregateEventsHandler(options)
  });
};

export {
  addAnalyticsRoutes
};
